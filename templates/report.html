<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WellTechFlow - Tu Diagnóstico de Bienestar</title>
    
    <!-- Favicon -->
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}" type="image/x-icon">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        .report-section {
            margin-bottom: 2.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #e9ecef;
        }
        .report-section:last-child {
            border-bottom: none;
        }
        .section-icon {
            font-size: 2.5rem;
            color: #2ecc71; /* Verde esmeralda */
            margin-bottom: 1rem;
        }
        .report-card {
            border: none;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border-radius: 10px;
            overflow: hidden;
        }
        .summary-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .report-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .recommendations-list li {
            margin-bottom: 1rem;
        }
        .action-button {
            margin-top: 1.5rem;
        }
        .highlight {
            background-color: #e8f4f8;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #3498db; /* Azul tecnológico */
            margin: 1.5rem 0;
        }
        .print-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        @media print {
            .no-print {
                display: none !important;
            }
            .print-only {
                display: block !important;
            }
            body {
                padding-top: 0 !important;
                font-size: 12pt;
            }
            .container {
                max-width: 100%;
                width: 100%;
            }
            .report-card {
                box-shadow: none !important;
                border: 1px solid #dee2e6 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="welltech-gradient text-white py-3 no-print">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="mb-0"><span class="logo-text">Well<span class="tech">Tech</span><span class="flow" style="color: #ffffff;">Flow</span></span></h1>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0"><i class="fas fa-phone-alt me-2"></i> Contacto: {{ config.get('CONTACT_PHONE', '+1234567890') }}</p>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Print Header -->
    <div class="d-none print-only text-center py-4">
        <h1><span class="logo-text">Well<span class="tech">Tech</span><span class="flow" style="color: #2ecc71;">Flow</span></span></h1>
        <p>{{ config.get('COMPANY_NAME', 'WellTechFlow') }} | {{ config.get('CONTACT_EMAIL', 'contacto@welltechflow.com') }}</p>
        <hr>
    </div>
    
    <!-- Main Content -->
    <main class="py-5">
        <div class="container">
            <div class="report-container">
                <!-- Report Header -->
                <div class="text-center mb-5">
                    <h2 class="display-6 fw-bold mb-3">Tu Análisis VitalScan Personalizado</h2>
                    <p class="lead">
                        Basado en la información proporcionada, nuestro sistema de IA ha generado este diagnóstico
                        integral con recomendaciones específicas para optimizar tu bienestar.
                    </p>
                </div>
                
                <!-- Personal Info -->
                <div class="report-section">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-user-circle section-icon me-3"></i>
                        <h3>Información Personal</h3>
                    </div>
                    
                    <div class="card report-card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><strong>Nombre:</strong> {{ diagnostico.nombre }} {{ diagnostico.apellido }}</li>
                                        <li class="mb-2"><strong>Edad:</strong> {{ diagnostico.edad }} años</li>
                                        <li class="mb-2"><strong>Género:</strong> {{ diagnostico.genero }}</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><strong>Fecha:</strong> {{ diagnostico.fecha }}</li>
                                        <li class="mb-2"><strong>Email:</strong> {{ diagnostico.email }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Habits and Health Status -->
                <div class="report-section">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-heartbeat section-icon me-3"></i>
                        <h3>Hábitos y Estado de Salud</h3>
                    </div>
                    
                    <div class="card report-card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>Hábitos</h5>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><strong>Sueño:</strong> {{ diagnostico.habitos_sueno }}</li>
                                        <li class="mb-2"><strong>Alimentación:</strong> {{ diagnostico.habitos_alimentacion }}</li>
                                        <li class="mb-2"><strong>Actividad física:</strong> {{ diagnostico.actividad_fisica }}</li>
                                        <li class="mb-2"><strong>Nivel de estrés:</strong> {{ diagnostico.estres }}</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h5>Estado de Salud</h5>
                                    {% if diagnostico.sintomas %}
                                    <p><strong>Síntomas actuales:</strong></p>
                                    <p>{{ diagnostico.sintomas }}</p>
                                    {% else %}
                                    <p><em>No se reportaron síntomas.</em></p>
                                    {% endif %}
                                    
                                    {% if diagnostico.antecedentes %}
                                    <p><strong>Antecedentes médicos:</strong></p>
                                    <p>{{ diagnostico.antecedentes }}</p>
                                    {% else %}
                                    <p><em>No se reportaron antecedentes médicos.</em></p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Diagnostic Summary -->
                <div class="report-section">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-stethoscope section-icon me-3"></i>
                        <h3>Diagnóstico</h3>
                    </div>
                    
                    <div class="card report-card">
                        <div class="card-body">
                            <div class="summary-card">
                                <p class="lead">
                                    <i class="fas fa-quote-left text-muted me-2"></i>
                                    Basado en el análisis de tus hábitos y estado de salud actual.
                                    <i class="fas fa-quote-right text-muted ms-2"></i>
                                </p>
                            </div>
                            
                            <div class="diagnostic-content">
                                {{ diagnostico.diagnostico|safe }}
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recommendations -->
                <div class="report-section">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-lightbulb section-icon me-3"></i>
                        <h3>Recomendaciones Personalizadas</h3>
                    </div>
                    
                    <div class="card report-card">
                        <div class="card-body">
                            <div class="recommendations-content">
                                {{ diagnostico.recomendaciones|safe }}
                            </div>
                            
                            <div class="highlight">
                                <p class="mb-0">
                                    <strong>Nota importante:</strong> Las recomendaciones proporcionadas son de carácter general.
                                    Para orientación específica, te recomendamos consultar con un profesional de la salud.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Next Steps -->
                <div class="report-section no-print">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-forward section-icon me-3"></i>
                        <h3>Siguientes Pasos</h3>
                    </div>
                    
                    <div class="card report-card">
                        <div class="card-body">
                            <p>Para obtener el máximo beneficio de este diagnóstico, te recomendamos:</p>
                            
                            <div class="row g-4 mt-2">
                                <div class="col-md-4">
                                    <div class="text-center">
                                        <i class="fas fa-calendar-check fa-3x text-primary mb-3"></i>
                                        <h5>Agenda una consulta</h5>
                                        <p>Habla con un especialista para revisar tu diagnóstico a detalle.</p>
                                        <a href="{{ url_for('success', diagnostico_id=diagnostico.id) }}" class="btn btn-outline-primary action-button">
                                            Agendar cita
                                        </a>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center">
                                        <i class="fas fa-file-download fa-3x text-success mb-3"></i>
                                        <h5>Descarga tu informe</h5>
                                        <p>Guarda una copia de tu diagnóstico completo.</p>
                                        <a href="{{ url_for('download_report', diagnostico_id=diagnostico.id) }}" class="btn btn-outline-success action-button">
                                            Descargar PDF
                                        </a>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center">
                                        <i class="fas fa-share-alt fa-3x text-info mb-3"></i>
                                        <h5>Comparte tu diagnóstico</h5>
                                        <p>Envía tu diagnóstico a tu médico o compártelo con familiares.</p>
                                        <div class="d-flex justify-content-center gap-2 action-button">
                                            <button class="btn btn-outline-info" onclick="shareByEmail()">
                                                <i class="fas fa-envelope"></i>
                                            </button>
                                            <button class="btn btn-outline-success" onclick="shareByWhatsApp()">
                                                <i class="fab fa-whatsapp"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Disclaimer -->
                <div class="mt-5">
                    <div class="alert alert-info" role="alert">
                        <h5 class="alert-heading"><i class="fas fa-info-circle me-2"></i> Aviso importante</h5>
                        <p>
                            Este diagnóstico es informativo y no sustituye la consulta con un profesional de la salud.
                            Si presentas síntomas graves o tienes dudas sobre tu salud, te recomendamos buscar 
                            atención médica inmediata.
                        </p>
                    </div>
                </div>
                
                <!-- Action buttons at the bottom -->
                <div class="d-flex justify-content-center gap-3 mt-5 no-print">
                    <a href="{{ url_for('success', diagnostico_id=diagnostico.id) }}" class="btn btn-primary">
                        <i class="fas fa-chevron-left me-1"></i> Volver a resultados
                    </a>
                    <button class="btn btn-success" onclick="window.print()">
                        <i class="fas fa-print me-1"></i> Imprimir diagnóstico
                    </button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Fixed Print Button -->
    <button class="btn btn-success btn-lg rounded-circle print-button no-print" onclick="window.print()">
        <i class="fas fa-print"></i>
    </button>
    
    <!-- Footer -->
    <footer class="welltech-gradient text-white py-4 mt-5 no-print">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5><span class="logo-text">Well<span class="tech">Tech</span><span class="flow" style="color: #ffffff;">Flow</span></span></h5>
                    <p class="mb-0">{{ config.get('BRAND_TAGLINE', 'Transformando el bienestar a través de la tecnología') }}</p>
                </div>
                <div class="col-md-4 mb-4 mb-md-0">
                    <h5>Contacto</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-envelope me-2"></i> {{ config.get('CONTACT_EMAIL', 'contacto@welltechflow.com') }}</li>
                        <li><i class="fas fa-phone me-2"></i> {{ config.get('CONTACT_PHONE', '+1234567890') }}</li>
                        <li><i class="fas fa-map-marker-alt me-2"></i> {{ config.get('CONTACT_ADDRESS', 'Quito, Ecuador') }}</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Síguenos</h5>
                    <div class="social-links d-flex mb-3">
                        <a href="{{ config.get('SOCIAL_FACEBOOK', '#') }}" class="text-white me-3"><i class="fab fa-facebook-f fa-lg"></i></a>
                        <a href="{{ config.get('SOCIAL_TWITTER', '#') }}" class="text-white me-3"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="{{ config.get('SOCIAL_INSTAGRAM', '#') }}" class="text-white me-3"><i class="fab fa-instagram fa-lg"></i></a>
                        <a href="{{ config.get('SOCIAL_LINKEDIN', '#') }}" class="text-white"><i class="fab fa-linkedin-in fa-lg"></i></a>
                    </div>
                    <p class="small">Suscríbete a nuestro boletín para recibir consejos y novedades sobre bienestar integral.</p>
                </div>
            </div>
            <hr class="my-4 opacity-25">
            <div class="d-flex flex-column flex-md-row justify-content-md-between align-items-center">
                <p class="mb-2 mb-md-0">&copy; {{ now.year }} {{ config.get('COMPANY_NAME', 'WellTechFlow') }}. Todos los derechos reservados.</p>
                <ul class="list-inline mb-0">
                    <li class="list-inline-item"><a href="#" class="text-white text-decoration-underline">Políticas de Privacidad</a></li>
                    <li class="list-inline-item"><a href="#" class="text-white text-decoration-underline">Términos de Uso</a></li>
                    <li class="list-inline-item"><a href="#" class="text-white text-decoration-underline">Aviso Legal</a></li>
                </ul>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom Scripts -->
    <script>
        // Funciones para compartir
        function shareByEmail() {
            const subject = encodeURIComponent('Mi diagnóstico de bienestar');
            const body = encodeURIComponent('Hola,\n\nQuiero compartir contigo mi diagnóstico de bienestar. Puedes verlo aquí:\n\n{{ request.url }}\n\nSaludos!');
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        }
        
        function shareByWhatsApp() {
            const text = encodeURIComponent('¡Hola! Quiero compartir contigo mi diagnóstico de bienestar. Puedes verlo aquí: {{ request.url }}');
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }
        
        // Formatear diagnóstico y recomendaciones para mejor presentación
        document.addEventListener('DOMContentLoaded', function() {
            // Formatear el diagnóstico (convertir saltos de línea en párrafos)
            const diagnosticContent = document.querySelector('.diagnostic-content');
            if (diagnosticContent) {
                const text = diagnosticContent.innerHTML;
                const paragraphs = text.split('\n\n').filter(p => p.trim() !== '');
                if (paragraphs.length > 0) {
                    diagnosticContent.innerHTML = paragraphs.map(p => `<p>${p.replace(/\n/g, '<br>')}</p>`).join('');
                }
            }
            
            // Formatear las recomendaciones (convertir en lista si hay viñetas)
            const recommendationsContent = document.querySelector('.recommendations-content');
            if (recommendationsContent) {
                const text = recommendationsContent.innerHTML;
                
                // Buscar patrones de listas (como - o •)
                if (text.match(/^[\s]*[-•*][\s]+/m)) {
                    const lines = text.split('\n').filter(line => line.trim() !== '');
                    const formattedList = [];
                    
                    let inList = false;
                    let currentList = '';
                    
                    lines.forEach(line => {
                        if (line.match(/^[\s]*[-•*][\s]+/)) {
                            if (!inList) {
                                inList = true;
                                currentList = '<ul class="recommendations-list">';
                            }
                            currentList += `<li>${line.replace(/^[\s]*[-•*][\s]+/, '')}</li>`;
                        } else {
                            if (inList) {
                                inList = false;
                                currentList += '</ul>';
                                formattedList.push(currentList);
                                currentList = '';
                            }
                            formattedList.push(`<p>${line}</p>`);
                        }
                    });
                    
                    if (inList) {
                        currentList += '</ul>';
                        formattedList.push(currentList);
                    }
                    
                    recommendationsContent.innerHTML = formattedList.join('');
                } else {
                    // Si no hay patrones de lista, formatear como párrafos
                    const paragraphs = text.split('\n\n').filter(p => p.trim() !== '');
                    if (paragraphs.length > 0) {
                        recommendationsContent.innerHTML = paragraphs.map(p => `<p>${p.replace(/\n/g, '<br>')}</p>`).join('');
                    }
                }
            }
        });
    </script>
</body>
</html> 